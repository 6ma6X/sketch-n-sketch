<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <!-- BEGIN LOADED_SRC src/head.src.html -->
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <title>Sketch-N-Sketch</title>
    <link rel="shortcut icon" type="image/png" href="../static/images/sketch-n-sketch-logo.png">
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="../static/css/arvo.css" />
    <link rel="stylesheet" type="text/css" href="../static/css/style.css" />
    <!-- END LOADED_SRC src/head.src.html -->
  </head>
</head>
<body>
<body>
  <div id="wrapper">

    <div id="header">
      <div id="logo"> <h1>Sketch-N-Sketch [<a href="index.html">Tutorial</a>]</h1> </div>
      <!-- BEGIN LOADED_SRC src/menu.src.html -->
      <div id="menu">
        <ul>
          <li class="first current_page_item"><a href="../index.html">Home</a></li>
          <li><a href="../blog/index.html">Blog</a></li>
          <li><a href="../releases/index.html">Demo</a></li>
          <li class="last"><a href="https://github.com/ravichugh/sketch-n-sketch">Code</a></li>
        </ul>
        <br class="clearfix" />
      </div>
      <!-- END LOADED_SRC src/menu.src.html -->
    </div>

    <div id="page">

      <div class="content_wide">
      <div class="blog_post">
<h1 id="step-3-indirect-manipulation-using-ui-widgets">Step 3: Indirect Manipulation using UI Widgets</h1>
<p><br> This third lesson will cover:</p>
<ul>
<li>Ways to directly manipulate attributes that have no obvious direct representation.</li>
</ul>
<p>This is a major and somewhat complicated topic, so we will spend the whole section on it. In addition, you'll get the chance to pursue a somewhat more involved design than you have in the previous two lessons, both to reinforce what you've already learned and to take advantage of this new design pattern.</p>
<h3 id="motivating-ui-widgets">Motivating UI Widgets</h3>
<p>The results of direct manipulation changes in Sketch-n-Sketch have so far brought &quot;traditional&quot; user interface behavior to a setting where the output is generated by programs written in a high-level language. For example, dragging a rectangle affects its x- and y-positions; stretching the border of a circle affects its radius attribute; and so on.</p>
<p>As you begin to tackle more ambitious projects, however, you will discover that there are some attributes that you simply cannot manipulate directly. One example is the color of a shape. Many direct manipulation tools, such as Illustrator and PowerPoint, offer menus and sliders to control properties such as these, which have no obvious direct representation. Instead, sliders and other <em>user interface widgets</em> provide &quot;indirect&quot; manipulation over such attributes.</p>
<h4 id="color-numbers">Color Numbers</h4>
<p>Sketch-n-Sketch provides some basic support for user interface widgets like color sliders. As described in the first lesson, there are multiple ways to define the color of a shape in Little (as a valid CSS color string, and as a four-element list of numbers that specifies an RGBA value).</p>
<p>Alternatively, the color attribute may be defined using what we call a <em>color number</em>, which is an integer in the range [<code>0</code>, <code>500</code>). This notion, though non-standard, has a simple meaning: the numbers <code>0</code> to <code>360</code> cover a wide range of colors across the entire spectrum, and <code>361</code> to <code>499</code> cover a grayscale spectrum. These 500 numbers constitute a large enough variety of colors for most of our purposes. More importantly, the Sketch-n-Sketch editor provides special support when color attributes are defined using these color numbers.</p>
<p><strong>Practice 3.1:</strong> To see how this works, first write a simple program that draws a single shape. Then modify your program to use a color number, and then run it. Next, toggle the Zones to display Color zones, rather than the Basic ones that we have been using so far. You'll notice that the shape is now equipped with a slider that can be used to change the color number value. That is, this slider indirectly manipulates the color of the particular shape. And better yet, as you have become accustomed to throughout this tutorial, this indirect manipulation is tied directly to the Little program, where the color number attribute is updated in real-time as you manipulate the slider. Not bad!</p>
<p><strong>Exercise 3.1:</strong> Return to your rectangles example from the previous lesson, and modify the program to use a color number instead. Toggle the Zones to Color, and try manipulating one of the sliders. You'll notice that each rectangle gets its own color slider, which can clutter the canvas and which is also unnecessary since all your rectangles share the same color number. Not to worry, because Sketch-n-Sketch provides a way to hide some unnecessary zones like these. The function call</p>
<pre><code>(basicZonesTail shapes)</code></pre>
<p>is a cue that only the first shape in a list of shapes (the &quot;head&quot; of the list) should be given a color slider zone and that the rest of the shapes in the list (the &quot;tail&quot; of the list) should only have the Basic zones. Besides this, the call to <code>basicZonesTail</code> has no effect on the actual output canvas of the program. Try adding a call to <code>basicZonesTail</code> in front of the <code>(map placeRectangle [0 1 2])</code> expression in your program. This constitutes a small way to customize the user interface in Sketch-n-Sketch, a theme that will crop up again and again in this lesson. (If you're curious to see a bit more of what's going on under the hood, take a peek at <a href="https://github.com/ravichugh/sketch-n-sketch/blob/master/examples/prelude.little">the Prelude source</a>).</p>
<h3 id="example-arranging-boxes-in-a-circle">Example: Arranging Boxes in a Circle</h3>
<p>No matter how awesome a GUI editor may be, not all attributes can be pre-wired to enable all kinds of directly manipulation the user may want. Beyond color, there are many other attributes in larger projects that are prime candidates for indirect manipulation. We will now work through one such example. But then we'll demonstrate how, without any additional built-in support from Sketch-n-Sketch, we can easily write our own tools to manipulate them anyway.</p>
<p>Our goal will be to implement a design with <code>n</code> squares evenly spaced along an imaginary circle of a given <code>radius</code>. Along the way, we'll learn about some more functions that come pre-loaded with Sketch-n-Sketch. Let's start by defining a circle, using variables to make it easy to refer to them later:</p>
<pre><code>(def [xCircle yCircle radius] [100 100 130]) 
(def theCircle (circle 400 xCircle yCircle radius))</code></pre>
<p>As you may remember from trigonometry class (or pre-calculus, depending on how recently you were in high school), a point <em>(x,y)</em> along a circle of a given <code>radius</code> can be computed as <em>(cos θ, sin θ)</em> in terms of an angle <em>θ</em>. Remember that <em>θ</em> starts at zero on the x-axis and increases in the counterclockwise direction, returning to the start when <em>θ</em> equals two times <em>π</em>. We'll use these equations to help compute the positions of <code>n</code> boxes along the edge of <code>theCircle</code>, using the trusty</p>
<pre><code>(map drawingFunction indices)</code></pre>
<p>pattern we have seen several times throughout the tutorial. In particular, we can start with:</p>
<pre><code>(def [n boxLen] [7 40])
(def boxIndices ( ... someListHere ... ))

(def placeSquare (\i
  (let theta ( ... someCalculationGoesHere ... )
  (square 200
    (+ xCircle (* radius (cos theta)))
    (- yCircle (* radius (sin theta)))
    boxLen))))

(def theBoxes (map placeSquare boxIndices))

; The Main Canvas
(svg (append [theCircle] theBoxes)) </code></pre>
<p>Notice here that we've used <code>let</code> to define a variable <code>theta</code> that only has scope within the function definition. This means that the name <code>theta</code> can only be used in this definition and so we can reuse the name later if we would like. Furthermore, this is the first time that we've used the trigonometric functions <code>sin</code> and <code>cos</code>. They are invoked just like any other function and only take one argument that should be expressed in radians. Finally, notice that the y-value calculation for the square uses a <code>-</code> instead of a <code>+</code> like the x-value calculation. This is because the coordinate system for SVG graphics and our canvas is such that the y-position increases towards the down direction of the screen (which you may have noticed if you payed close attention as you manipulated our previous examples).</p>
<p><strong>Practice 3.2:</strong> To get things rolling, create a new file in the editor and enter what we have established so far, including the top-level definitions mentioned earlier. Fill in the missing expressions with some reasonable dummy values to start, just so that we can start to visualize parts of our output canvas.</p>
<p>Now, we have to figure out we should actually define <code>theta</code> and <code>boxIndices</code>. Since there are <em>2π</em> radians in a circle, the <code>i</code>th box out of <code>n</code> boxes should be placed at <code>(* i (/ (* 2! (pi)) n))</code> radians to be spaced evenly. Notice that <em>π</em> is written as <code>(pi)</code> in Little. You can think of it as a built-in function that is called with zero arguments (which explains the parentheses). We freeze the number <code>2</code> because it is not something that should ever change. Let's drop this calculation of <code>theta</code> into our template from above:</p>
<pre><code>(def placeSquare (\i
  (let theta (* i (/ (* 2! (pi)) n))
  (square 200
    (+ xCircle (* radius (cos theta)))
    (- yCircle (* radius (sin theta)))
    boxLen))))</code></pre>
<p>The last thing we need to do is define a list of indices from <code>1</code> to <code>n</code>. Sketch-n-Sketch provides a function called <code>range</code> that computes precisely what we need (take a peek at the <a href="https://github.com/ravichugh/sketch-n-sketch/blob/master/examples/prelude.little">Prelude source code</a> if you want to see how to write this (recursive) function in Little):</p>
<pre><code>(def boxIndices (range 1 n)) </code></pre>
<p>Make these changes and re-run the program.</p>
<p><strong>Practice 3.3:</strong> When you toggle color zones, you'll see a whole slew of sliders sliding around. Make judicious use of the <code>basicZonesTail</code> function to hide the redundant ones.</p>
<p><strong>Exercise 3.2:</strong> You'll notice that position of the squares isn't quite right: the top-left corners, rather than their centers, fall on the edge of the circle. Modify the computed x- and y-positions inside <code>placeSquare</code> so that the boxes are centered along the circle's edge.</p>
<h4 id="directly-manipulating-the-number-of-boxes">Directly Manipulating the Number of Boxes</h4>
<p>If you've started to directly manipulate the shapes, you will find that changing the overall <code>radius</code> of the circle and <code>boxLen</code> of the boxes is pretty natural. But changing the number <code>n</code> of boxes is not so easy. Even though some of the interior zones of the boxes are such that hovering over them highlights the <code>n</code> variable in <span class="hoverYellow">yellow</span> to indicate that it will change, it becomes <span class="hoverRed">red</span> when you actually attempt to change it. In this case, Sketch-n-Sketch is able to determine that the <code>n</code> variable goes into the calculation of the position because of its role in determining <code>theta</code>, but it is unable to infer any program updates as a result of direct manipulation.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<!-- way to see what I mean, go ahead. Having warned you, this tutorial's
conscience is clean.

Even though we cannot directly manipulate the total number of boxes with the
program as is, -->
<p><strong>Practice 3.4:</strong> It would be really nice if there was a way to change the total number of boxes without having do adjust a number by hand in the source code. Fortunately, we can accomplish this by defining a &quot;helper object&quot; where one of its attributes is defined to be the &quot;indirect&quot; parameter <code>n</code> used by the rest of the program. In this way, we can then directly manipulate this parameter without having to touch the original source program ourselves.</p>
<p>Behold the following helper object:</p>
<pre><code>(def helperObject
  (let xHelper (+ 10! (* 50! n))
  (square &#39;lightgreen&#39; xHelper 10! 50!)))

(svg (append [theCircle helperObject] theBoxes)) </code></pre>
<p>The key is the x-position, namely, the <code>xHelper</code> expression that is computed using <code>n</code>. Since all other constants that go into this expression are frozen, Sketch-n-Sketch will definitely manipulate <code>n</code> when dragging the box horizontally. We choose to freeze the y-position of <code>helperObject</code>, so that it will only slide horizontally, not vertically. Try dragging this box back and forth. You're now directly manipulating what was previously an indirect parameter, and all using functions you already know! Cool, right?</p>
<h4 id="little-sliders">Little Sliders</h4>
<p>Since defining helper shapes (what we call <em>user interface widgets</em>) is very common, we've defined a few nice-looking sliders that can be used instead of having to build your own helper objects. For example, there is the <code>hSlider</code> function that takes arguments as follows:</p>
<pre><code>(hSlider roundInt xStart xEnd y minVal maxVal caption curVal)</code></pre>
<p>This returns two items in a list: the first element is the value that is being manipulating and the second is the list of SVG elements that make up the slider. The argument <em><code>roundInt</code></em> is a boolean (<code>true</code> or <code>false</code>) that indicates whether or not the variable that it modifies should be rounded to the nearest integer. The <em><code>xStart</code></em> and <em><code>xEnd</code></em> parameters indicate the x-positions between which the slider should be drawn, and <em><code>y</code></em> indicates the y-position. The <em><code>minVal</code></em> and <em><code>maxVal</code></em> parameters denote the minimum and maximum values for the variable controlled by the slider, and <em><code>caption</code></em> provides a label. Finally, <em><code>curVal</code></em> represents the current value of the variable that it determines, and it is set when first creating the slider to indicate the initial value.</p>
<p>Usually, a call to <code>hSlider</code> is paired with a <code>def</code> or <code>let</code>, as in the following example:</p>
<pre><code>(def [varName varSlider] (hSlider false 100! 500! 300! 0 100 &#39;varName: &#39; 20))</code></pre>
<p>Then, <code>varName</code> can be used in your program like any other variable. Remember, in order for the slider to appear, the list of shapes in <code>varSlider</code> must be appended to the <code>svg</code> statement at the end of your program.</p>
<p><strong>Practice 3.5:</strong> Let's go back to our earlier example of the boxes arranged in a circle. To specify a slider that accomplishes the same thing as our <code>helperObject</code>, we can replace it with the following. You should remove the original definition of <code>n</code>, because now it is one of the return values from the slider. And this new <code>def</code> should go near the top of the program, before you use the <code>n</code> variable anywhere else.</p>
<pre><code>(def [n nSlider] (hSlider true 30! 300! 30! 1! 7! &#39;Number of Boxes: &#39; 3))</code></pre>
<p>Finally, you should update the main canvas as follows:</p>
<pre><code>(svg (concat [[theCircle] theBoxes nSlider]))</code></pre>
<p>Here, the library function <code>concat</code> is used to concatenate multiple lists into a single list. Try this out.</p>
<p>It is important to note that the <code>hSlider</code> function is written in Little without any &quot;extra&quot; support from Sketch-n-Sketch. This is in contrast to the built-in color sliders for color numbers from earlier. The main takeaway is that the programmer has the power to customize the user interface beyond what comes pre-packaged into the design. This is a powerful idea that we believe demonstrates the potential benefits of combining programmatic and direct manipulation approach in Sketch-n-Sketch.</p>
<p>For more inspiration, we've provided other sample slider implementations in the built-in examples Sliders, Buttons, Widgets, 2D Slider, and Color Picker. Coming up with useful widgets and reusing them in later projects is a good idea, so feel free to copy what we've done if it helps your workflow. Take a look at the Box Grid, Active Trans, and Ferris Wheel examples to see how we have put custom UI widgets to good use.</p>
<h3 id="mini-project">Mini-Project</h3>
<p>Now that we've gone through a significant amount of material, it's time for you to tackle a bigger project! Go ahead and do the following (in order would probably be easiest):</p>
<p><strong>Exercise 3.3:</strong> Choose a design that you would like to create. It should involve at least three kinds of shapes and be complicated enough to be interesting to you. You may find it helpful to sketch on paper at this point.</p>
<p><strong>Exercise 3.4:</strong> Choose a subset of the design that is all one shape and such that the elements are logically linked to one another. Write a placement function and map it over a list of indices or a list of some parameter to generate that subset of the image that is made of repeated elements.</p>
<p><strong>Exercise 3.5:</strong> If possible, reduce that list of indices or parameters to an expression that is determined according to only one or two variables. The <code>range</code> function is very handy for simplifying index lists and mapping a <code>generateParameter</code> function over a list of indices generated by <code>range</code> is also a good way to generate a list of logically linked parameters.</p>
<p><strong>Exercise 3.6:</strong> Create or use an existing UI widget to manipulate this parameter or parameters.</p>
<p><strong>Exercise 3.7:</strong> Pick another subset of this design and repeat the above process. Continue this until you've completed the design, feeling free to &quot;turn off&quot; the UI widgets that you are not using anymore as well as freezing parameters that you have set how you like.</p>
<p>To get the creative juices flowing, here are some suggested project ideas:</p>
<ul>
<li>A more full-featured color picker than the built-in color slider. Being able to cover all of the RGBA values would be desirable.</li>
<li>A simple picture of a house, like <a href="http://www.sbccaofmn.com/wp-content/uploads/2012/05/house-%20clipart.gif">this</a>.</li>
<li>A geometric art piece with repetitive elements. Feel free to channel your inner <a href="https://www.google.com/search?q=mondrian+minimalist+art&amp;tbm=isch">Mondrian</a>.</li>
</ul>
<h3 id="survey">Survey</h3>
<iframe src="https://docs.google.com/forms/d/1o-7LHX08JOvUs0oiWUa6zWVROpt8oAXXgthpKm3EjbQ/viewform?embedded=true" width="750" height="1450" frameborder="0" marginheight="0" marginwidth="0">
Loading...
</iframe>
<p><br></p>
<h3 id="next-up-step-4">Next Up: <a href="04.html">Step 4</a></h3>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Actually, it is possible to define <code>placeSquare</code> in such a way as to make the <code>theta</code> &quot;increment&quot; for each square in terms of the position of the first box and then, from that, deduce the overall number of squares to place using this increment. If done in this fashion, direct manipulation of the position of this first square will change the number of squares. However, this is likely to be a rather convoluted way to set up the program and, worse, will make manipulating <code>radius</code>, <code>xCircle</code>, and <code>yCircle</code> parameters drastically less intuitive. However, if you are curious, you may enjoy trying this out anyway.<a href="#fnref1">↩</a></p></li>
</ol>
</div>
      </div>
      </div>

      <br class="clearfix" />

    </div> <!-- end id="page" -->

  </div> <!-- end id="wrapper" -->

  <!-- BEGIN LOADED_SRC src/footer.src.html -->
  <div id="footer">
    &copy; 2015 ravi chugh |
  	stylesheet based on
    <a href="http://www.freecsstemplates.org/preview/resolved/">Resolved</a>
  </div>
  <!-- END LOADED_SRC src/footer.src.html -->

  <!-- BEGIN LOADED_SRC src/ga-tracker.src.html -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-5371203-2', 'auto');
    ga('send', 'pageview');
  
  </script>
  <!-- END LOADED_SRC src/ga-tracker.src.html -->

</body>
</html>
</body>
</html>
